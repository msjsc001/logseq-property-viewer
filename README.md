# Logseq 属性查询与统计 GUI 工具(NiceGUI)

**这是一个独立于 Logseq 软件之外的高性能桌面工具，用于对 Logseq 知识库中的 Markdown 文件进行高级的属性查询和数据统计，** 并以现代化的图形用户界面（GUI）展示结果，如果你使用logseq的属性方式来进行属性键值，**它都同时能支持，所以它通用于所有md格式。**

![20210606180518](https://github.com/user-attachments/assets/44dd628b-0520-4afa-8367-154613091f37)


---

## ✨ 核心功能

- **智能增量缓存**:
    - **首次加速**：第一次运行时，工具会全面扫描知识库并建立缓存。
    - **闪电更新**：后续运行时，仅需数秒即可完成对新增、修改或删除文件的增量检查，极大提升了大型知识库的启动和分析速度。
    - **手动管理**：提供手动更新缓存和一键清理所有缓存的功能，操作位于“基础设置”选项卡中。

- **高级属性查询**:
    - 在“高级属性查询”选项卡中，支持精确匹配 (`key:value`)、模糊匹配 (`key~value`) 和存在性匹配 (`has:key`)。
    - 支持 `AND` / `OR` 逻辑运算符进行复杂条件组合。
    - 查询结果以功能强大的 Ag-Grid 动态表格展示，支持列排序、列筛选和列拖拽；系统会按“知识库路径 + 原始查询语句”记忆列排序与列位置，并在下次同查询时自动恢复。新增列会自动排在末尾并写入记忆。
    - **动态列显示**：可以根据查询结果，动态选择显示或隐藏特定的属性列，并长期记忆每个路径的列可见性偏好。

- **数据统计与分析**:
    - 在“数据统计与分析”选项卡中，一键扫描并分析整个知识库，找出所有使用过的属性“键”。
    - **属性键搜索**：支持通过输入关键词，实时筛选数量庞大的属性键列表。
    - 以表格和文本条形图的形式，直观展示任一属性键的值分布情况，帮助您洞察知识库的数据模式。

- **高性能与用户体验**:
    - **异步执行**：所有耗时操作（如文件扫描、查询）都在后台执行，确保界面始终流畅响应，不会冻结。
    - **现代化 GUI**：基于 `NiceGUI` 构建，界面美观，通过选项卡组织功能，交互直观。
    - **状态持久化**：自动保存上次使用的知识库路径，启动后即可恢复工作状态。

## 🚀 如何使用

### 1. 环境准备

本工具基于 Python 开发，并使用 [NiceGUI](https://nicegui.io/) 框架构建 GUI。请确保您的系统已安装 Python 3.8+。

### 2. 安装依赖

在您的终端中，克隆或下载项目后，使用 `pip` 通过 `requirements.txt` 文件安装所有必要的库：

```bash
pip install -r requirements.txt
```

### 3. 运行程序

通过项目的主入口文件 `main.py` 来启动本工具：

```bash
python main.py
```

程序启动后，将打开一个独立的桌面窗口。请在“基础设置”页面中填入您 Logseq 知识库的**绝对路径**，然后点击“建立/更新缓存”，完成后即可开始使用各项功能。
- 查询结果允许使用列头升降序或多列排序；系统会记住“知识库路径 + 原始查询语句”的排序组合与列位置，下次执行同样的查询会自动恢复。新增的列或结果会默认排在现有顺序后面。
- 清理：在“基础设置 -> 缓存管理”中点击“只清理-高级属性查询-排序”即可清除当前路径或全部路径的排序与列位置记忆；“清理所有缓存”同样会一并移除所有排序、列位置与列过滤偏好。

## 📂 文件结构

项目遵循关注点分离原则，将代码解耦到不同的模块中，以提高可维护性和可扩展性。

```
.
├── main.py             # 🔵 应用主入口 (启动NiceGUI)
├── nicegui_ui.py       # 🎨 用户界面与交互逻辑 (View & Controller)
├── core.py             # ⚙️ 核心解析逻辑 (Model)
├── cache.py            # ⚡ 智能缓存管理模块
├── config.py           # 💾 用户配置的加载与保存
├── requirements.txt    # 📦 Python 依赖列表
└── README.md           # 📄 项目说明文档
```

- **`main.py`**: 职责单一，仅用于实例化并运行 NiceGUI 应用。
- **`nicegui_ui.py`**: **应用的核心**。封装了所有 UI 组件、界面布局和事件处理逻辑。它负责接收用户输入，调用其他模块（如 `cache.py` 和 `core.py`）执行后台任务，并将结果渲染到界面上，扮演着视图（View）和控制器（Controller）的角色。
- **`core.py`**: 专注于最核心的原子任务：从单个 Markdown 文件内容中解析并提取属性。它不处理文件 I/O，只负责解析逻辑，是纯粹的模型（Model）层。
- **`cache.py`**: **项目性能的关键**。封装了所有与缓存相关的操作，包括智能检测文件变动、增量更新、加载和保存缓存。
- **`config.py`**: 将用户配置（如知识库路径）的读写逻辑从主应用中分离出来，使其易于管理和扩展。

---
- 更新摘要（v0.1）
  - 标题栏显示版本号 v0.1。
  - 高级属性查询的“选择要显示的列”支持全局记忆（按路径）。
  - “所属页面”列可在“选择要显示的列”中勾选/取消，并支持搜索定位。
  - 列选择对话框新增搜索框（支持中文/英文名称）。
  - 右键菜单新增“复制”选项，点击后再写入剪贴板并弹出提示。
  - 设置页新增“只清理-高级属性查询-过滤”，并将“建立/更新缓存”重命名为“只本路径库-建立/更新缓存”。
  - “清理所有缓存”同时清除所有路径的列过滤偏好。
- 更新摘要（v0.2）
  - “所属页面”在在“选择要显示的列”中勾选/取消失效的修复。
  - 右键复制弹窗功能。
